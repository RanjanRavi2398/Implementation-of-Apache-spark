{"version":"NotebookV1","origId":4259324615413894,"name":"00_getting_started","language":"python","commands":[{"version":"CommandV1","origId":4259324615413895,"guid":"fb344a27-4b2b-4fd7-ad44-c50cc714b17b","subtype":"command","commandType":"auto","position":1.0,"command":"\n%md-sandbox\n\n<div style=\"text-align: center; line-height: 0; padding-top: 9px;\">\n  <img src=\"https://databricks.com/wp-content/uploads/2018/03/db-academy-rgb-1200px.png\" alt=\"Databricks Learning\" style=\"width: 600px\">\n</div>","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joshua.cook@databricks.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"41bcaeb3-e790-4b52-90c7-af54d678ae57"},{"version":"CommandV1","origId":4259324615413896,"guid":"bbf0cec2-5f0a-4788-866d-d7b4ec25b8cf","subtype":"command","commandType":"auto","position":2.0,"command":"%md\n# Getting Started","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joshua.cook@databricks.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"68b80f26-2768-4281-9d64-0bad596944b7"},{"version":"CommandV1","origId":4259324615413897,"guid":"17b73041-d2a6-49bc-8ad2-5c15613468ed","subtype":"command","commandType":"auto","position":3.0,"command":"%md\n## Configuration","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joshua.cook@databricks.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"ea0508bb-273a-4ced-a172-d794d5dc0f73"},{"version":"CommandV1","origId":4259324615413898,"guid":"492a0a58-d7b0-4634-8aa3-939e58e36e7c","subtype":"command","commandType":"auto","position":4.0,"command":"%run ./includes/utilities","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joshua.cook@databricks.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"38c8e1f6-ca61-4071-9e06-73784dde432b"},{"version":"CommandV1","origId":4259324615413899,"guid":"fc6112b8-8302-4914-8e65-d28c7536e415","subtype":"command","commandType":"auto","position":5.0,"command":"%md\n## Make Notebook Idempotent\n\nThis step will make the notebook\n[idempotent](https://stackoverflow.com/a/1077421/1081801). In other\nwords, the notebook could be run more than once without throwing errors\nor introducing extra files.","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joshua.cook@databricks.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"494ae8e3-cd0b-47b2-88f6-47b34ec4ff12"},{"version":"CommandV1","origId":4259324615413900,"guid":"a24db583-55c6-47ab-95f4-4b70c5d660e6","subtype":"command","commandType":"auto","position":6.0,"command":"dbutils.fs.rm(projectPath, recurse=True)","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joshua.cook@databricks.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"d4eafee3-3493-4732-9c2c-5160a5630cb4"},{"version":"CommandV1","origId":4259324615413901,"guid":"70ff83a2-2d7f-40f5-ae3b-b0e796e4ca58","subtype":"command","commandType":"auto","position":7.0,"command":"%md\n## Retrieve and Load the Data\n\nWe will be working with two files:\n\n- \"health_profile_data.snappy.parquet\"\n- \"user_profile_data.snappy.parquet\"\n\nThese files can be retrieved and loaded using the utility function `process_file`\n\nThis function takes three arguments:\n\n- `file_name: str`\n   - the name of the file to retrieve\n- `path: str`\n   - the location to write the file as a Delta table\n- `table_name: str`\n   - the name of a table to be used in the Metastore to reference the data\n\nThis function does three things:\n\n1. Retrieve a file and load it into your Databricks Workspace.\n1. Create a Delta table using the file.\n1. Register the Delta table in the Metastore so that it can be\n   referenced using SQL or a PySpark `table` reference.","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joshua.cook@databricks.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"328908df-dae5-4fd9-ba64-12a91097801c"},{"version":"CommandV1","origId":4259324615413902,"guid":"930876d0-03f7-4e04-9623-f909753e8944","subtype":"command","commandType":"auto","position":8.0,"command":"%md\n### Retrieve and Load the Data\n\nRetrieve the data using the following arguments:\n\n| `file_name` | `path` | `table_name` |\n|:-:|:-:|:-|\n| `health_profile_data.snappy.parquet` | `silverDailyPath` | `health_profile_data` |\n| `user_profile_data.snappy.parquet`   | `dimUserPath`     | `user_profile_data`   |","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joshua.cook@databricks.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"ccb1eccf-8478-4dac-abf7-e93d93b770b7"},{"version":"CommandV1","origId":4259324615413903,"guid":"cff66105-2163-45e4-adc3-4a882bcfa53a","subtype":"command","commandType":"auto","position":9.0,"command":"# ANSWER\nprocess_file(\n  \"health_profile_data.snappy.parquet\",\n  silverDailyPath,\n  \"health_profile_data\"\n)\nprocess_file(\n  \"user_profile_data.snappy.parquet\",\n  dimUserPath,\n  \"user_profile_data\"\n)","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joshua.cook@databricks.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"7f682906-c7be-4b5a-8665-5b52218c5435"},{"version":"CommandV1","origId":4259324615413904,"guid":"57760fee-d73b-4c3b-9bf1-cfca990e8e2f","subtype":"command","commandType":"auto","position":10.0,"command":"%md\n## Data Availability\n\nIn a typical workflow, data will have been made available to you\nas tables that can be queried using SQL or PySpark. This function\n`process_file` has performed the steps necessary to make the files\navailable to your workspace so that you can focus on data science.\nThis mirrors a typical workflow, where the data has been made\navailable to you by a data engineer.\n","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joshua.cook@databricks.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"3971ed35-b2e2-4624-83a0-5a7a49d07e0f"},{"version":"CommandV1","origId":4259324615413905,"guid":"c5efb94a-a2b8-4ead-927b-c8016b29cc60","subtype":"command","commandType":"auto","position":11.0,"command":"%md-sandbox\n&copy; 2020 Databricks, Inc. All rights reserved.<br/>\nApache, Apache Spark, Spark and the Spark logo are trademarks of the <a href=\"http://www.apache.org/\">Apache Software Foundation</a>.<br/>\n<br/>\n<a href=\"https://databricks.com/privacy-policy\">Privacy Policy</a> | <a href=\"https://databricks.com/terms-of-use\">Terms of Use</a> | <a href=\"http://help.databricks.com/\">Support</a>","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"joshua.cook@databricks.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"3fc79d29-b2df-4633-b12c-bc3343ce5105"}],"dashboards":[],"guid":"53a7b47b-33d6-49ab-9ab0-c272a0ba2094","globalVars":{},"iPythonMetadata":null,"inputWidgets":{}}