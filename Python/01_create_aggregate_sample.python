{"version":"NotebookV1","origId":4259324615413740,"name":"01_create_aggregate_sample","language":"python","commands":[{"version":"CommandV1","origId":4259324615413741,"guid":"8346d03e-3170-4156-a7bf-6930a5ddfccd","subtype":"command","commandType":"auto","position":1.0,"command":"\n%md-sandbox\n\n<div style=\"text-align: center; line-height: 0; padding-top: 9px;\">\n  <img src=\"https://databricks.com/wp-content/uploads/2018/03/db-academy-rgb-1200px.png\" alt=\"Databricks Learning\" style=\"width: 600px\">\n</div>","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"54650c27-75a7-4ac5-97ea-e553f45f10e0"},{"version":"CommandV1","origId":4259324615413742,"guid":"ff9ea96f-91e2-4a11-a1d8-59d48bb04af2","subtype":"command","commandType":"auto","position":2.0,"command":"%md\n# Create Aggregate Sample Data","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"c31651e1-0d41-44e8-8d21-348751d950d9"},{"version":"CommandV1","origId":4259324615413743,"guid":"e468a2db-880e-407e-943e-b59c6e5bcbf3","subtype":"command","commandType":"auto","position":3.0,"command":"%md\n## Configuration","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"976f1417-7614-4868-8b22-f2fb0a989e81"},{"version":"CommandV1","origId":4259324615413744,"guid":"5b0f925b-a4d1-43e6-af4e-0e548c8fb758","subtype":"command","commandType":"auto","position":4.0,"command":"%run ./includes/configuration","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"ab6b73f8-c9ba-4e91-a4a8-f25f06c98b09"},{"version":"CommandV1","origId":4259324615413745,"guid":"d4b77e76-60b9-4044-83ea-de1846a81f51","subtype":"command","commandType":"auto","position":5.0,"command":"%md\n## Define Spark References to Data\n\nIn the next cell, we use Apache Spark to define a reference to the data\nwe will be working with.\n\nWe need to create references to the following Delta tables:\n\n- `user_profile_data`\n- `health_profile_data`\n\n\uD83D\uDEE0 **Note:** Because we are working in Databricks, `spark`, a reference to the\nSpark Session on the cluster we are working with, is already available to us.","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"7071fa80-1e3d-46df-b985-da61bb254aab"},{"version":"CommandV1","origId":4259324615413746,"guid":"f68fd9d2-7856-4a9f-8c63-9526263fe741","subtype":"command","commandType":"auto","position":6.0,"command":"# TODO\n# Use spark.read to create references to the two tables as dataframes\n\nuser_profile_df = spark.read FILL_THIS_IN\nhealth_profile_df = spark.read FILL_THIS_IN","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"21bc2a0f-e1bf-4ecf-be3b-2f10506c5172"},{"version":"CommandV1","origId":4259324615413747,"guid":"b061ffce-e71a-4b45-908b-a80f9fe0a8a5","subtype":"command","commandType":"auto","position":7.0,"command":"%md\n### Data Schema\n\nUse Apache Spark to display the schemas of the data.","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"46b685b6-7962-4b55-9788-34282a755dd9"},{"version":"CommandV1","origId":4259324615413748,"guid":"a1675010-90fa-4411-b8ca-8ebfb9a1da93","subtype":"command","commandType":"auto","position":8.0,"command":"# TODO\nprint(\"User Profile Data\")\nuser_profile_df FILL_THIS_IN\nprint(\"Health Profile Data\")\nhealth_profile_df FILL_THIS_IN","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"3fe8289f-b29f-4be4-8531-05278147738a"},{"version":"CommandV1","origId":4259324615413749,"guid":"7216c1d6-69a4-464f-89d6-cbd7890b7d9a","subtype":"command","commandType":"auto","position":9.0,"command":"%md\n### Display the Count of the User Profile Data","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"9370ad61-ea78-4313-bf37-198b56dc9046"},{"version":"CommandV1","origId":4259324615413750,"guid":"60c949a0-625f-48e2-b017-9672c22aa4ba","subtype":"command","commandType":"auto","position":10.0,"command":"user_profile_df.count()","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"78fb32f6-b9b2-4a59-be2b-8dfa8cc716b8"},{"version":"CommandV1","origId":4259324615413751,"guid":"c2d8a9ea-7a9b-4473-959e-9308f53846d7","subtype":"command","commandType":"auto","position":11.0,"command":"%md\n### Display the Minimum and Maximum Dates In the Health Profile Data","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"68ef2ea2-e13a-414b-ad66-e13c9a5ff66d"},{"version":"CommandV1","origId":4259324615413752,"guid":"e86cce8a-9a8e-44b3-9b3a-1175c8cec5c6","subtype":"command","commandType":"auto","position":12.0,"command":"# TODO\nfrom pyspark.sql.functions import min, max\n\ndisplay(\n  health_profile_df FILL_THIS_IN\n)","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"53e6ba69-6bee-478e-b535-6db8c7ad56e3"},{"version":"CommandV1","origId":4259324615413753,"guid":"4a098156-f811-416a-92b2-ced53e7abb30","subtype":"command","commandType":"auto","position":13.0,"command":"%md\n### Display the Distinct Lifestyles in the User Profile Data","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"8ab48311-c900-47a8-84e1-a39f9fa74c91"},{"version":"CommandV1","origId":4259324615413754,"guid":"8e2406ed-402f-4847-9cf8-09df4af521e4","subtype":"command","commandType":"auto","position":14.0,"command":"display(user_profile_df.select(\"lifestyle\").distinct())","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"b135572a-13e9-47fd-a48b-0bfcaf9d28dc"},{"version":"CommandV1","origId":4259324615413755,"guid":"eb8bcc0f-3676-435f-beae-1c9e1024ef18","subtype":"command","commandType":"auto","position":15.0,"command":"%md\n### Generate a Sample of Users","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"23f5f107-a93d-4ba4-88c3-3a09d18590fe"},{"version":"CommandV1","origId":4259324615413756,"guid":"66fe883f-ab6b-43a4-8172-148c0e4965cd","subtype":"command","commandType":"auto","position":16.0,"command":"user_profile_sample_df = user_profile_df.sample(0.03)\n\ndisplay(user_profile_sample_df.groupby(\"lifestyle\").count())","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"c3649d2d-996e-40bd-a83c-2adcff9cbb33"},{"version":"CommandV1","origId":4259324615413757,"guid":"fd7ce8f8-11a0-4f7f-a25d-fe970e902064","subtype":"command","commandType":"auto","position":17.0,"command":"%md\n### Join the User Profile Data to the Health Profile Data\n\nPerform the join using the `_id` column.\n\nIf successful, You should have 365 times as many rows as are in the user sample.","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"c00374d8-f857-4e8a-a5d1-ad9cd5a9246f"},{"version":"CommandV1","origId":4259324615413758,"guid":"613d5cdc-afba-4ef3-9977-acdf874c5699","subtype":"command","commandType":"auto","position":18.0,"command":"# TODO\nhealth_profile_sample_df = (\n  FILL_THIS_IN\n)\n\nassert 365*user_profile_sample_df.count() == health_profile_sample_df.count()","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"6e83da69-c161-42d2-a6c1-b6bc37359800"},{"version":"CommandV1","origId":4259324615413759,"guid":"efcc0b65-8c66-4606-87f6-052a3ff46ca2","subtype":"command","commandType":"auto","position":19.0,"command":"%md\n### Display the User Profile Sample","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"4202278b-18c8-4a9f-8a27-531d5f654d2f"},{"version":"CommandV1","origId":4259324615413760,"guid":"89cf831e-db5c-40fc-9a73-afae1ffdb8d0","subtype":"command","commandType":"auto","position":20.0,"command":"display(health_profile_sample_df)","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"74dfec78-af9f-4351-810d-d3d4984ca2bd"},{"version":"CommandV1","origId":4259324615413761,"guid":"347a9046-61cc-4268-a047-66587e4386b4","subtype":"command","commandType":"auto","position":21.0,"command":"%md\n## Aggregate the Data and Store It as an Aggregate Table\n\nYou should perform the following aggregations:\n\n- mean `BMI` aliased to `mean_BMI`\n- mean `active_heartrate` aliased to `mean_active_heartrate`\n- mean `resting_heartrate` aliased to `mean_resting_heartrate`\n- mean `VO2_max` aliased to `mean_VO2_max`","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"e78dc46e-1b98-49e5-83d5-04a283951575"},{"version":"CommandV1","origId":4259324615413762,"guid":"6643b9eb-47a7-43ce-9005-77c36059757a","subtype":"command","commandType":"auto","position":22.0,"command":"# TODO\nfrom pyspark.sql.functions import mean, col\n\nhealth_tracker_sample_agg_df = (\n    health_profile_sample_df.groupBy(\"_id\", \"lifestyle\")\n    .agg(\n        FILL_THIS_IN\n    )\n)","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"6879d1da-1300-484d-90e6-e6a05c76f82c"},{"version":"CommandV1","origId":4259324615413763,"guid":"264002a5-c3a3-4cfe-aa66-22134aec728f","subtype":"command","commandType":"auto","position":23.0,"command":"from pyspark.sql.types import _parse_datatype_string\n\naggregate_schema = \"\"\"\n  _id string,\n  lifestyle string,\n  mean_BMI double,\n  mean_active_heartrate double,\n  mean_resting_heartrate double,\n  mean_VO2_max double\n\"\"\"\n\nassert health_tracker_sample_agg_df.schema == _parse_datatype_string(aggregate_schema)","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"e0c059f4-51d6-4264-9841-4dd591e21ca0"},{"version":"CommandV1","origId":4259324615413764,"guid":"b472bc75-7063-4064-a5cf-0dbdfbf26ab2","subtype":"command","commandType":"auto","position":24.0,"command":"%md\n### Write the Aggregation Dataframe to a Delta Table\n\nUse the following path: `goldPath + \"health_tracker_sample_agg\"`","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"0d260ee1-1d4d-4e2d-8856-21f2fdd8929f"},{"version":"CommandV1","origId":4259324615413765,"guid":"6aa42825-a7a8-419b-87c4-89877f83eb9a","subtype":"command","commandType":"auto","position":25.0,"command":"# TODO\n(\n  health_tracker_sample_agg_df.write\n  .format(\"delta\")\n  .mode(\"overwrite\")\n  FILL_THIS_IN\n)\n","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"bbd4bb02-0cdf-432c-979b-dac85c42f8d9"},{"version":"CommandV1","origId":4259324615413766,"guid":"3f0722e9-1373-4f59-802a-c0df32e65fcc","subtype":"command","commandType":"auto","position":26.0,"command":"%md-sandbox\n&copy; 2020 Databricks, Inc. All rights reserved.<br/>\nApache, Apache Spark, Spark and the Spark logo are trademarks of the <a href=\"http://www.apache.org/\">Apache Software Foundation</a>.<br/>\n<br/>\n<a href=\"https://databricks.com/privacy-policy\">Privacy Policy</a> | <a href=\"https://databricks.com/terms-of-use\">Terms of Use</a> | <a href=\"http://help.databricks.com/\">Support</a>","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"985b58d4-0cd6-42c6-8447-52e7127797a4"}],"dashboards":[],"guid":"44576df5-ee80-49a3-b602-4f49bef64b96","globalVars":{},"iPythonMetadata":null,"inputWidgets":{}}